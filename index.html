<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPE File Analysis Tool</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1>SPE File Analysis Tool</h1>
    </header>

    <main>
        <!-- 왼쪽 패널: 파일 선택 및 제어 -->
        <div class="panel" id="left-panel">
            <fieldset>
                <legend>Select File</legend>
                <input type="file" id="fileInput" accept=".spe" onchange="handleFileSelect(this)">
            </fieldset>

            <fieldset>
                <legend>Frame List</legend>
                <div id="frame-list-container">
                    <p>SPE 파일을 선택하세요.</p>
                </div>
                <button id="avgButton" style="display: none;">체크된 프레임 평균 보기</button>
            </fieldset>

            <fieldset>
                <legend>Intensity Control</legend>
                <div class="slider-container">
                    <label for="rangeMin">min:</label>
                    <input type="number" id="rangeMinInput" min="0" max="65535" value="0" class="intensity-input">
                    <input type="range" id="rangeMin" min="0" max="65535" value="0">
                </div>
                <div class="slider-container">
                    <label for="rangeMax">max:</label>
                    <input type="number" id="rangeMaxInput" min="0" max="65535" value="65535" class="intensity-input">
                    <input type="range" id="rangeMax" min="0" max="65535" value="65535">
                </div>
            </fieldset>
             <fieldset>
                <legend>Data Cropping & Averaging</legend>
                 <p>이 범위로 잘라내어 값들의 평균을 텍스트로 저장합니다.</p>
                <div class="crop-grid">
                    <span>X:</span>
                    <input type="number" id="cropXFrom" placeholder="from">
                    <span>→</span>
                    <input type="number" id="cropXTo" placeholder="to">
                    <span>step:</span>
                    <input type="number" id="cropXStep" placeholder="step">
                </div>
                <div class="crop-grid">
                    <span>Y:</span>
                    <input type="number" id="cropYFrom" placeholder="from">
                    <span>→</span>
                    <input type="number" id="cropYTo" placeholder="to">
                    <span>step:</span>
                    <input type="number" id="cropYStep" placeholder="step">
                </div>
                <button id="saveAvgData">평균값 텍스트로 저장</button>
            </fieldset>
        </div>

        <!-- 오른쪽 패널: 이미지 및 그래프 표시 -->
        <div class="panel" id="right-panel">
            <div id="canvas-container" style="position: relative;">
                <canvas id="previewCanvas" width="800" height="600"></canvas>
                <!-- 픽셀 정보 표시창 추가 -->
                <div id="pixel-info"></div>
            </div>
            <div id="profile-container">
                 <canvas id="profileCanvas" width="800" height="200"></canvas>
            </div>
            <div id="analysis-tools">
                <fieldset>
                    <legend>Analysis Tools</legend>
                    <div class="tool-section">
                        <strong>Select Row (Peak):</strong>
                        <button id="setPeak1">파란선(1) 설정</button>
                        <button id="setPeak2">주황선(2) 설정</button>
                        <span>Δx: <b id="peakDelta">N/A</b> px</span>
                        <span>center: <b id="peakCenter">N/A</b> px</span>
                    </div>
                     <div class="tool-section">
                        <strong>Select Row (Integral):</strong>
                        <button id="setIntegral1">노란선(1) 설정</button>
                        <button id="setIntegral2">노란선(2) 설정</button>
                        <span>Integral: <b id="integralValue">N/A</b></span>
                    </div>
                    <div class="tool-section">
                        <strong>Fitting:</strong>
                        <p>피팅 기능은 여기에 추가될 수 있습니다.</p>
                    </div>
                </fieldset>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
</body>
</html>
